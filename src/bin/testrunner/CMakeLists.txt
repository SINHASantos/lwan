include_directories(BEFORE ${CMAKE_BINARY_DIR})

add_executable(testrunner main.c)

target_link_libraries(testrunner
	${LWAN_COMMON_LIBS}
	${ADDITIONAL_LIBRARIES}
)

if (${CMAKE_BUILD_TYPE} MATCHES "Coverage")
	if (Python3_Interpreter_FOUND)
		setup_target_for_coverage(generate-coverage
			"${Python3_EXECUTABLE} ${CMAKE_SOURCE_DIR}/src/scripts/testsuite.py -v ${CMAKE_BINARY_DIR}"
			coverage
		)
		add_dependencies(generate-coverage testrunner)
		message(STATUS "Python found; generate-coverage target enabled")
	else ()
		message(STATUS "Python not found; coverage report disabled")
	endif()
endif ()
